<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style/tabs.css">
    <link rel="stylesheet" href="style/vars.css">
    <link rel="stylesheet" href="style/controls.css">
    <link rel="stylesheet" href="style/chess.css">
    <link rel="stylesheet" href="style/api.css">
    <title>Simple chess</title>
</head>
<body>
    <div id="modal_container" class="hidden">
        <div id="modal_background"></div>
        <div id="endgame_modal">
            <div id="endgame_message">Game over!</div>
            <div id="endgame_button" class="neutral_button">OK</div>
        </div>
    </div>
    <div id="dragging_piece"></div>
    <center>
        <div id="options_tabs">
            <div id="play_tab" class="tab">
                Play chess
            </div>
            <div id="api_guide_tab" class="tab inactive_tab">
                API guide
            </div>
            <div id="explore_api_tab" class="tab inactive_tab">
                Explore API
            </div>
        </div>
        <div id="options_container">
            <div id="play_section">
                <div id="board" class="not_flipped"></div>
                <div id="controls_vertical_container">
                    <div id="restart_button">
                        Restart game
                    </div>
                    <div id="board_controls" class="controls_not_flipped">
                        <div id="black_controls" class="player_controls">
                            <br/>
                            Black Player:
                            <br/>
                            <div class="control_row">
                                <div id="black_human_button" class="control_button">
                                    Human
                                </div>
                                <div id="black_ai_button" class="control_button control_button_selected">
                                    AI
                                </div>
                            </div>
                            <div id="black_human" class="hidden">
                                This is a human player
                            </div>
                            <div id="black_turn" class="your_turn hidden">
                                <br/>
                                Your turn!
                            </div>
                            <div id="black_select_level">
                                Select AI level:
                            </div>
                            <div id="black_ai_levels_1" class="control_row">
                                <div id="black_0_button" class="control_button button_small">
                                    0
                                </div>
                                <div id="black_1_button" class="control_button button_small">
                                    1
                                </div>
                                <div id="black_2_button" class="control_button button_small">
                                    2
                                </div>
                            </div>
                            <div id="black_ai_levels_2" class="control_row">
                                <div id="black_3_button" class="control_button button_small control_button_selected">
                                    3
                                </div>
                                <div id="black_4_button" class="control_button button_small">
                                    4
                                </div>
                                <div id="black_5_button" class="control_button button_small">
                                    5
                                </div>
                            </div>
                            <div id="black_message" class="hidden">
                                thinking...
                            </div>
                        </div>
                        <div id="neutral_controls">
                            <div id="switch_sides_button" class="neutral_button">
                                <div>&uarr;</div>
                                <div class="squish">&darr;</div>
                            </div>
                            <div id="turn_board_button" class="neutral_button">
                                <div class="upsidedown">&crarr;</div>
                                <div class="squish">&crarr;</div>
                            </div>
                            <div id="neutral_button_message">
                            </div>
                        </div>
                        <div id="white_controls" class="player_controls white_section">
                            <br/>
                            White Player:
                            <br/>
                            <div class="control_row">
                                <div id="white_human_button" class="control_button control_button_selected">
                                    Human
                                </div>
                                <div id="white_ai_button" class="control_button">
                                    AI
                                </div>
                            </div>
                            <div id="white_human">
                                This is a human player
                            </div>
                            <div id="white_turn" class="your_turn">
                                <br/>
                                Your turn!
                            </div>
                            <div id="white_select_level" class="hidden">
                                Select AI level:
                            </div>
                            <div id="white_ai_levels_1" class="control_row hidden">
                                <div id="white_0_button" class="control_button button_small">
                                    0
                                </div>
                                <div id="white_1_button" class="control_button button_small">
                                    1
                                </div>
                                <div id="white_2_button" class="control_button button_small">
                                    2
                                </div>
                            </div>
                            <div id="white_ai_levels_2" class="control_row hidden">
                                <div id="white_3_button" class="control_button button_small control_button_selected">
                                    3
                                </div>
                                <div id="white_4_button" class="control_button button_small">
                                    4
                                </div>
                                <div id="white_5_button" class="control_button button_small">
                                    5
                                </div>
                            </div>
                            <div id="white_message" class="hidden">
                                thinking...
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="api_guide_section" class="hidden">
                <h2>Guide to simpleChessMove API</h2>
                The simpleChessMove API is publicly available and can suggest a move for any game. Below is an example query:
                <p class="api_text_box">
                    fetch("https://airbackend.com/chessMove/api.php", {
                        <br/>
                        &nbsp; &nbsp;
                        method: "POST",
                        <br/>
                        &nbsp; &nbsp;
                        body: JSON.stringify({
                            <br/>
                            &nbsp; &nbsp; &nbsp; &nbsp;
                            request: "nextMove",
                            <br/>
                            &nbsp; &nbsp; &nbsp; &nbsp;
                            gameState: "rnbqkbnrpppppppp--------------------------------PPPPPPPPRNBQKBNRw1111",
                            <br/>
                            &nbsp; &nbsp; &nbsp; &nbsp;
                            level: 3
                            <br/>
                            &nbsp; &nbsp;
                        }).then((result) => {
                            <br/>
                            &nbsp; &nbsp; &nbsp; &nbsp;
                            result.json().then((jsonResult) => {
                                <br/>
                                &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                                console.log(jsonResult);
                            <br/>
                            &nbsp; &nbsp; &nbsp; &nbsp;
                            });
                        <br/>
                        &nbsp; &nbsp;
                        });
                        <br/>
                    });
                </p>
                <br/>
                The parameter "gameState" is a string that contains all the relevant information about the game:
                <br/>
                <br/>
                The first 64 characters represent the spaces on the board. White pieces are indicated by lowercase letters, black pieces
                are indicated by uppdercase letters, and dashes indicate empty spaces. The ranks are listed in ascending order with spaces
                left to right from white's perspective, so the first 8 characters, "rnbqkbnr", represent white's major pieces.
                <br/>
                <br/>
                The next character is either "w" or "b" and indicates who's turn it is. The API will return a move for that side.
                <br/>
                <br/>
                The next four characters are either 1s or 0s and indicate which castle moves are still allowed in order of white kingside, white queenside,
                black kingside, and black queenside.
                <br/>
                <br/>
                The state shown above is a new game, before white has taken its first move. Suppose white moves pawn to e4. Then the state would look
                like this:
                <p class="api_text_box">
                            &nbsp; &nbsp; &nbsp; &nbsp;
                            rnbqkbnrpppp-ppp------------p-------------------PPPPPPPPRNBQKBNRb111134     
                </p>
                <br/>
                Note that in addition to the pawn moving, two additional characters, "34", are attached
                to the end of the string.
                <br/>
                <br/>
                Those two optional characters indicate that the most recent move was a two-space pawn move,
                so the API can consider en passant moves in its response. The two characters represent the location
                of the pawn that just moved, in [row, column] order, both zero-indexed. So the pawn that just moved
                is now on row 3, in column 4. Space [0, 0] is the first rank, all the way to white's left.
                <br/>
                <br/>
                The "request" parameter specifies what is requested of the API, and can be "nextMove" or "checkMove".
                "checkMove" sends a move and requests the API to determine if it is a legal move; see below for more about that.
                <br/>
                <br/>
                The "level" parameter is an integer from 0 to 5 and specifies the level of analysis the API should use. The algorithm
                will look that number of moves ahead and choose a move that leads to checkmate, or, if that's impossible, maximizes
                the resulting advantage in points after the specified number of moves. Level 0 will not look ahead at all and simply
                returns a random move.
                <br/>
                <br/>
                <b>Important note:</b> Level 5 is experimental. It may time out, return a result worse than level 4, or
                return an error. All other levels should suggest a move within 10 seconds.
                <br/>
                <br/>
                The suggested move comes back in a similar form as the request, with the state of the game after the
                suggested move specified by a single string. For the query above, the unpacked json result "jsonResult" would look
                something like this:
                <p class="api_text_box">
                {
                    <br/>
                    &nbsp; &nbsp; 
                    prev: "rnbqkbnrpppppppp--------------------------------PPPPPPPPRNBQKBNRb1111",
                    <br/>
                    &nbsp; &nbsp;
                    score: 0,
                    <br/>
                    &nbsp; &nbsp;
                    level: 3,
                    <br/>
                    &nbsp; &nbsp;
                    move: [
                        <br/>
                        &nbsp; &nbsp; &nbsp; &nbsp;
                        [6, 3],
                        <br/>
                        &nbsp; &nbsp; &nbsp; &nbsp;
                        [4, 3]
                    <br/>
                    &nbsp; &nbsp;
                    ],
                    <br/>
                    &nbsp; &nbsp;
                    next: "rnbqkbnrpppp-ppp------------p-------------------PPPPPPPPRNBQKBNRw1111"
                <br/>    
                }  
                </p>
                <br/>
                "next" in this response is the state of the game after the recommended move is made.
                <br/>
                <br/>
                The response also comes with additional data: "prev" is the game state was sent in the request. "score" is the
                total of all white's pieces' points minus the total of all black's piece's points(So white wants to increase this
                number and black wants to decrease it). "level" is the number of moves ahead the algorithm looked. And "move" is
                the suggested move in array form. It's an array containing two subarrays, which are the beginning and ending coordinates
                of the piece to be moved.
                <br/>
                <br/>
                For special moves (castling, en passant, and pawn promotion) the "move" array will have a third element, a string, indicating the
                special move:
                <br/>
                &nbsp; &nbsp;
                "castle" indicates a castle move. The coordinates will be for moving the king.
                <br/>
                &nbsp; &nbsp;
                "enPassant" indicates an en passant move. The coordinates will be for moving the capturing pawn.
                <br/>
                &nbsp; &nbsp;
                Any other character indicates a pawn promotion, and the character represents the new piece that should replace the pawn.
                <br/>
                &nbsp; &nbsp;
                Ex: [[6, 3], [7, 3], "r"] is a pawn move from [6, 3] to [7, 3] and promoting it to a white rook.
                <br/>
                <h2>Using the API to validate a move</h2>
                The API can also be used to check if a move is legal. Here's an example query:
                <p class="api_text_box">
                    fetch("https://airbackend.com/chessMove/api.php", {
                        <br/>
                        &nbsp; &nbsp;
                        method: "POST",
                        <br/>
                        &nbsp; &nbsp;
                        body: JSON.stringify({
                            <br/>
                            &nbsp; &nbsp; &nbsp; &nbsp;
                            request: "checkMove",
                            <br/>
                            &nbsp; &nbsp; &nbsp; &nbsp;
                            gameState: "rnbqkbnrpppppppp--------------------------------PPPPPPPPRNBQKBNRw1111",
                            <br/>
                            &nbsp; &nbsp; &nbsp; &nbsp;
                            move: [[0, 1], [2, 2]]
                            <br/>
                            &nbsp; &nbsp;
                        }).then((result) => {
                            <br/>
                            &nbsp; &nbsp; &nbsp; &nbsp;
                            result.json().then((jsonResult) => {
                                <br/>
                                &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
                                console.log(jsonResult);
                            <br/>
                            &nbsp; &nbsp; &nbsp; &nbsp;
                            });
                        <br/>
                        &nbsp; &nbsp;
                        });
                        <br/>
                    });
                </p>

                Stay tuned - more explanation and examples to come!

            </div>
            <div id="explore_api_section" class="hidden">
                <h2>Use this tool to experiment with the API</h2>
                <br/>
                coming soon!
                <br/>
                <br/>
            </div>
        </div>
    </center>
    


    
    <script type="text/javascript" src="./output/main.js"></script>
</body>
</html>